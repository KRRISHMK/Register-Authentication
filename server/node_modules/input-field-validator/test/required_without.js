const Validator = require('../Validator');

describe('require field c if field b is not present', () => {
	it('both b and c absent', done => {
		const validator = new Validator({
			'a': '1'
		}, {
			'a': ['string', 'required'],
			'b': 'optional',
			'c': 'required_without:b'
		})
		if (validator.validate()) {
			done('Validation should fail');
			return;
		}

		done();
	});

	it('b present, c absent', done => {
		const validator = new Validator({
			'a': '1',
			'b': '2'
		}, {
			'a': ['string', 'required'],
			'b': 'optional',
			'c': 'required_without:b'
		})
		if (validator.validate()) {
			done();
			return;
		}

		done(validator.errors);
	});

	it('b absent, c present', done => {
		const validator = new Validator({
			'a': '1',
			'c': '3'
		}, {
			'a': ['string', 'required'],
			'b': 'optional',
			'c': 'required_without:b'
		})
		if (validator.validate()) {
			done();
			return;
		}

		done(validator.errors);
	});

	it('both b and c present', done => {
		const validator = new Validator({
			'a': '1',
			'b': '2',
			'c': '3'
		}, {
			'a': ['string', 'required'],
			'b': 'optional',
			'c': 'required_without:b'
		})
		if (validator.validate()) {
			done();
			return;
		}

		done(validator.errors);
	});
})
